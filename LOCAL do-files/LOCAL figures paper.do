/* Figures with summaries dataset */cd "D:"use ".\DTA\ConsumptionTaxes_indicators_coremodel.dta", clearappend using ".\DTA\ConsumptionTaxes_indicators_xtnddmodel.dta", generate(model)egen min_model = min(model), by(ccyy)drop if min_model == 0 & model == 1drop min_modellabel define model 0 "Core" 1 "Extended"label values model modelegen max_year = max(year), by(cname)egen max_year_obs = max(year) if !mi(M_inc5), by(cname)egen max_year_core = max(year) if model == 0, by(cname)egen max_year_central = max(year) if (model == 0) | ///	inlist(cname, "United States", "Norway", "Sweden", "Australia"), by(cname)gen central = year == max_year_central	 gen M_tcons_central = M_tcons if centralreplace M_tcons_central = M_tcons_pred if mi(M_tcons_central) & centralgen M_tax_central = M_tax if centralreplace M_tax_central = M_tax_pred if mi(M_tax_central) & centralgen M_inc5_central = M_inc5 if centralreplace M_inc5_central = M_inc5_pred if mi(M_inc5_central) & centralgen Gini_inc5_central = Gini_inc5 if centralreplace Gini_inc5_central = Gini_inc5_pred if mi(Gini_inc5_central) & centralgen Gini_diff_central = Gini_diff if centralreplace Gini_diff_central = Gini_diff_pred if mi(Gini_diff_central) & centralgen Kak_central = Kak if centralreplace Kak_central = Kak_pred if mi(Kak_central) & centralgen RS_central = RS if centralreplace RS_central = RS_pred if mi(RS_central) & centralgen Conc_tcons_central = Conc_tcons if centralreplace Conc_tcons_central = Conc_tcons_pred if mi(Conc_tcons_central) & centralgen Conc_inc5_central = Conc_inc5 if centralreplace Conc_inc5_central = Conc_inc5_pred if mi(Conc_inc5_central) & centralgen Conc_tax_central = Conc_tax if centralreplace Conc_tax_central = Conc_tax_pred if mi(Conc_tax_central) & central* set scheme s1monoset scheme s1color// Figure 2: actual and predicted Gini coefficientsgraph dot (asis) Gini_inc5_pred Gini_pre Gini_inc5 if year == max_year_obs, ///	over(model, relabel(1 " " 2 "*")) over(ccyy_f, sort(Gini_pre) descending) nofill exclude0 ///	marker(1, msymbol(lgx)) yscale(range(0.2 0.2)) legend(order(2 3 1) rows(3) span)	gen clock2 = 4replace clock2 = 10 if Gini_inc5_pred > Gini_inc5 | ccyy == "fr84"replace clock2 = 12 if inlist(ccyy, "pl13","au10")replace clock2 = 9 if inlist(ccyy, "fr89", "fr94")replace clock2 = 3 if inlist(ccyy, "si12", "hu07", "it95", "it08")twoway (scatter Gini_inc5_pred Gini_inc5 if Gini_inc5<0.4, mlabel(ccyy) mlabvpos(clock2)) ///	(function y = x, range(0.25 0.4)), ///	ytitle(Imputed consumption) xtitle(Observed consumption) graphregion(fcolor(white)) ///	legend(order(2 "Equality line") title(Gini index of Post-Tax Income))// Figure 4: Gini of market, gross, disposable and post tax incomegraph dot (asis) Gini_inc2 Gini_inc3 Gini_pre Gini_inc5_central if central & !mi(Gini_inc2), ///	over(ccyy_f, sort(Gini_inc5_central) descending) marker(1, msymbol(square)) ///	marker(2, msymbol(triangle)) marker(4, msymbol(lgx)) ///	legend(order(1 "Market Income" 2 "Gross Income" 3 "Disposable Income" 4 "Post-Tax Income") ///	rows(2) title(Gini index of income inequality)// Figure 5: estimated rise in Gini index due to consumption taxesgraph hbar (asis) Gini_diff_central if central, ///	over(ccyy_f, sort(Gini_diff_central) descending) ylabel(0(0.01)0.05)	// Figure 6: redistributive impact vs effective tax rategen clock = 9replace clock = 12 if inlist(cname, "Czech Republic", "United States")replace clock = 3 if inlist(cname, "Belgium", "Ireland", "Mexico")twoway (scatter Gini_diff_central effective_taxrate, mlabel(cname) mlabvpos(clock)) if central, ///	ytitle(Regressive impact (Gini points)) xtitle(Effective tax rate on consumption)	// Figure 7:gen mean_rate = M_tax_central/M_dhitwoway scatter Kak_central mean_rate if central, mlabel(cname) ///	|| function RS1 = -0.01*(1-x)/x, range(0.05 0.3) ///	|| function RS2 = -0.015*(1-x)/x, range(0.05 0.3) ///	|| function RS3 = -0.02*(1-x)/x, range(0.05 0.3) ///	|| function RS4 = -0.025*(1-x)/x, range(0.05 0.3) ///	|| function RS5 = -0.03*(1-x)/x, range(0.05 0.3) ///	|| function RS6= -0.035*(1-x)/x, range(0.05 0.3)